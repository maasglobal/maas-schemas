{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "https://api.maas.global/maas-backend/itineraries/itinerary-create/response",
  "description": "Response schema for itineraries-create",
  "type": "object",
  "properties": {
    "itinerary": {
      "$schema": "http://json-schema.org/draft-04/schema#",
      "id": "https://api.maas.global/core/itinerary",
      "description": "OpenTripPlanner itinerary, augmented with leg bookings per leg",
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "signature": {
              "type": "string"
            },
            "state": {
              "type": "string",
              "enum": [
                "START",
                "PLANNED",
                "PAID",
                "ACTIVATED",
                "CANCELLED",
                "CANCELLED_WITH_ERRORS",
                "FINISHED"
              ]
            },
            "startTime": {
              "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
              "type": "integer",
              "maximum": 9007199254740991,
              "minimum": 1451606400
            },
            "endTime": {
              "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
              "type": "integer",
              "maximum": 9007199254740991,
              "minimum": 1451606400
            },
            "fare": {
              "type": "object",
              "properties": {
                "co2": {
                  "type": "integer"
                },
                "points": {
                  "anyOf": [
                    {
                      "type": "integer"
                    },
                    {
                      "type": "null"
                    }
                  ]
                }
              },
              "required": [
                "co2",
                "points"
              ]
            },
            "legs": {
              "type": "array",
              "minItems": 0,
              "items": [
                {
                  "anyOf": [
                    {
                      "type": "object",
                      "properties": {
                        "signature": {
                          "type": "string"
                        },
                        "state": {
                          "type": "string",
                          "enum": [
                            "START",
                            "PLANNED",
                            "PAID",
                            "ACTIVATED",
                            "CANCELLED",
                            "CANCELLED_WITH_ERRORS",
                            "FINISHED"
                          ]
                        },
                        "from": {
                          "type": "object",
                          "additionalProperties": true,
                          "allOf": [
                            {
                              "description": "A place, as a location-name pair",
                              "type": "object",
                              "allOf": [
                                {
                                  "description": "Geographic latitude-longitude object in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                  "type": "object",
                                  "properties": {
                                    "lat": {
                                      "description": "Geographic latitude (north-south axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                      "type": "number",
                                      "minimum": -90,
                                      "maximum": 90,
                                      "multipleOf": 0.000001
                                    },
                                    "lon": {
                                      "description": "Geographic longitude (east-west axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                      "type": "number",
                                      "minimum": -180,
                                      "maximum": 180,
                                      "multipleOf": 0.000001
                                    }
                                  },
                                  "required": [
                                    "lat",
                                    "lon"
                                  ]
                                },
                                {
                                  "type": "object",
                                  "properties": {
                                    "name": {
                                      "type": "string",
                                      "minLength": 1
                                    }
                                  }
                                }
                              ]
                            },
                            {
                              "type": "object",
                              "properties": {
                                "stopId": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "stopCode": {
                                  "type": "string",
                                  "minLength": 1
                                }
                              }
                            }
                          ],
                          "required": [
                            "lat",
                            "lon"
                          ]
                        },
                        "to": {
                          "type": "object",
                          "additionalProperties": true,
                          "allOf": [
                            {
                              "description": "A place, as a location-name pair",
                              "type": "object",
                              "allOf": [
                                {
                                  "description": "Geographic latitude-longitude object in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                  "type": "object",
                                  "properties": {
                                    "lat": {
                                      "description": "Geographic latitude (north-south axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                      "type": "number",
                                      "minimum": -90,
                                      "maximum": 90,
                                      "multipleOf": 0.000001
                                    },
                                    "lon": {
                                      "description": "Geographic longitude (east-west axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                      "type": "number",
                                      "minimum": -180,
                                      "maximum": 180,
                                      "multipleOf": 0.000001
                                    }
                                  },
                                  "required": [
                                    "lat",
                                    "lon"
                                  ]
                                },
                                {
                                  "type": "object",
                                  "properties": {
                                    "name": {
                                      "type": "string",
                                      "minLength": 1
                                    }
                                  }
                                }
                              ]
                            },
                            {
                              "type": "object",
                              "properties": {
                                "stopId": {
                                  "type": "string",
                                  "minLength": 1
                                },
                                "stopCode": {
                                  "type": "string",
                                  "minLength": 1
                                }
                              }
                            }
                          ],
                          "required": [
                            "lat",
                            "lon"
                          ]
                        },
                        "startTime": {
                          "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": 1451606400
                        },
                        "endTime": {
                          "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": 1451606400
                        },
                        "mode": {
                          "anyOf": [
                            {
                              "description": "A mode that involves using your personal vehicle or legs",
                              "type": "string",
                              "enum": [
                                "WALK",
                                "BICYCLE",
                                "CAR"
                              ]
                            },
                            {
                              "description": "A mode that involves transit with fixed schedules",
                              "type": "string",
                              "enum": [
                                "TRAM",
                                "SUBWAY",
                                "RAIL",
                                "BUS",
                                "FERRY",
                                "TRANSIT",
                                "TRAIN",
                                "AEROPLANE"
                              ]
                            },
                            {
                              "description": "A mode that is available on-demand for your personal use",
                              "type": "string",
                              "enum": [
                                "CAR",
                                "TAXI",
                                "CABLE_CAR",
                                "GONDOLA",
                                "FUNICULAR",
                                "BUSISH",
                                "TRAINISH"
                              ]
                            }
                          ]
                        },
                        "departureDelay": {
                          "description": "duration in milliseconds (negative values permitted), https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": -9007199254740991
                        },
                        "arrivalDelay": {
                          "description": "duration in milliseconds (negative values permitted), https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": -9007199254740991
                        },
                        "distance": {
                          "description": "Distance in meters",
                          "type": "number",
                          "minimum": 0,
                          "maximum": 40075000,
                          "multipleOf": 0.000001
                        },
                        "route": {
                          "type": "string",
                          "minLength": 1
                        },
                        "routeShortName": {
                          "type": "string",
                          "minLength": 1
                        },
                        "routeLongName": {
                          "type": "string",
                          "minLength": 1
                        },
                        "agencyId": {
                          "type": "string",
                          "minLength": 2
                        },
                        "legGeometry": {
                          "type": "object",
                          "description": "Google encoded polyline, see: https://developers.google.com/maps/documentation/utilities/polylinealgorithm",
                          "properties": {
                            "points": {
                              "type": "string",
                              "minLength": 3,
                              "pattern": "^([\\x5F-\\x7E]*[\\x3F-\\x5E])+$"
                            }
                          },
                          "required": [
                            "points"
                          ],
                          "additionalProperties": false
                        },
                        "fare": {
                          "description": "A fare/price as billed from the user in POINTs",
                          "type": "object",
                          "properties": {
                            "amount": {
                              "type": "integer",
                              "minimum": 0
                            },
                            "currency": {
                              "type": "string",
                              "enum": [
                                "POINT"
                              ]
                            }
                          },
                          "required": [
                            "amount",
                            "currency"
                          ],
                          "additionalProperties": false
                        },
                        "product": {
                          "description": "Temporary way to define what kind of product has been purchased to get a ticket/booking. Will be replaced something more sophisticated once proper product system will be development.",
                          "type": "object",
                          "properties": {
                            "type": {
                              "description": "A type of ticket/product that this booking is valid for - should be unique within a given region, e.g. 'Single ticket / Lähiseutu 2'. When reusing the tickets in maas-backend, the 'type' field is checked for equality.",
                              "type": "string"
                            },
                            "id": {
                              "description": "Id of the product retrived from Database",
                              "type": "integer"
                            }
                          },
                          "additionalProperties": false
                        },
                        "bookingOption": {
                          "type": "number",
                          "minValue": 0
                        }
                      },
                      "required": [
                        "from",
                        "to",
                        "mode",
                        "startTime",
                        "endTime",
                        "legGeometry"
                      ],
                      "additionalProperties": true
                    },
                    {
                      "type": "object",
                      "additionalProperties": true,
                      "properties": {
                        "startTime": {
                          "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": 1451606400
                        },
                        "endTime": {
                          "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": 1451606400
                        },
                        "mode": {
                          "description": "A mode that only involves waiting in the current location",
                          "type": "string",
                          "enum": [
                            "WAIT"
                          ]
                        }
                      },
                      "required": [
                        "mode",
                        "startTime",
                        "endTime"
                      ]
                    },
                    {
                      "type": "object",
                      "additionalProperties": true,
                      "properties": {
                        "startTime": {
                          "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": 1451606400
                        },
                        "endTime": {
                          "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                          "type": "integer",
                          "maximum": 9007199254740991,
                          "minimum": 1451606400
                        },
                        "mode": {
                          "description": "A mode that involves changing transports",
                          "type": "string",
                          "enum": [
                            "TRANSFER",
                            "LEG_SWITCH"
                          ]
                        }
                      },
                      "required": [
                        "mode",
                        "startTime",
                        "endTime"
                      ]
                    }
                  ]
                }
              ]
            },
            "bookingOptions": {
              "type": "array",
              "minItems": 0,
              "items": {
                "$schema": "http://json-schema.org/draft-04/schema#",
                "id": "https://api.maas.global/core/itinerary",
                "description": "Booking option for an itinerary, is either an existing booking pointer or a new booking instruction",
                "type": "object",
                "properties": {
                  "productId": {},
                  "name": {},
                  "fare": {},
                  "ref": {},
                  "identityId": {},
                  "bookingId": {}
                }
              }
            }
          },
          "required": [
            "startTime",
            "endTime",
            "legs"
          ]
        }
      ],
      "properties": {
        "id": {
          "description": "Universally unique identifier, see https://en.wikipedia.org/wiki/Universally_unique_identifier",
          "type": "string",
          "pattern": "^[A-Fa-f0-9]{8}(-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}$"
        },
        "customer": {
          "type": "string",
          "pattern": "^[aepus]{2}-[\\w]{4}-\\d:[a-f\\d]{8}(-[a-f\\d]{4}){3}-[a-f\\d]{12}$"
        },
        "legs": {
          "type": "array",
          "minItems": 0,
          "items": {
            "properties": {
              "id": {
                "description": "Universally unique identifier, see https://en.wikipedia.org/wiki/Universally_unique_identifier",
                "type": "string",
                "pattern": "^[A-Fa-f0-9]{8}(-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}$"
              }
            },
            "anyOf": [
              {
                "type": "object",
                "properties": {
                  "signature": {
                    "type": "string"
                  },
                  "state": {
                    "type": "string",
                    "enum": [
                      "START",
                      "PLANNED",
                      "PAID",
                      "ACTIVATED",
                      "CANCELLED",
                      "CANCELLED_WITH_ERRORS",
                      "FINISHED"
                    ]
                  },
                  "from": {
                    "type": "object",
                    "additionalProperties": true,
                    "allOf": [
                      {
                        "description": "A place, as a location-name pair",
                        "type": "object",
                        "allOf": [
                          {
                            "description": "Geographic latitude-longitude object in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                            "type": "object",
                            "properties": {
                              "lat": {
                                "description": "Geographic latitude (north-south axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                "type": "number",
                                "minimum": -90,
                                "maximum": 90,
                                "multipleOf": 0.000001
                              },
                              "lon": {
                                "description": "Geographic longitude (east-west axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                "type": "number",
                                "minimum": -180,
                                "maximum": 180,
                                "multipleOf": 0.000001
                              }
                            },
                            "required": [
                              "lat",
                              "lon"
                            ]
                          },
                          {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "minLength": 1
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "object",
                        "properties": {
                          "stopId": {
                            "type": "string",
                            "minLength": 1
                          },
                          "stopCode": {
                            "type": "string",
                            "minLength": 1
                          }
                        }
                      }
                    ],
                    "required": [
                      "lat",
                      "lon"
                    ]
                  },
                  "to": {
                    "type": "object",
                    "additionalProperties": true,
                    "allOf": [
                      {
                        "description": "A place, as a location-name pair",
                        "type": "object",
                        "allOf": [
                          {
                            "description": "Geographic latitude-longitude object in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                            "type": "object",
                            "properties": {
                              "lat": {
                                "description": "Geographic latitude (north-south axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                "type": "number",
                                "minimum": -90,
                                "maximum": 90,
                                "multipleOf": 0.000001
                              },
                              "lon": {
                                "description": "Geographic longitude (east-west axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                                "type": "number",
                                "minimum": -180,
                                "maximum": 180,
                                "multipleOf": 0.000001
                              }
                            },
                            "required": [
                              "lat",
                              "lon"
                            ]
                          },
                          {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "minLength": 1
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "object",
                        "properties": {
                          "stopId": {
                            "type": "string",
                            "minLength": 1
                          },
                          "stopCode": {
                            "type": "string",
                            "minLength": 1
                          }
                        }
                      }
                    ],
                    "required": [
                      "lat",
                      "lon"
                    ]
                  },
                  "startTime": {
                    "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": 1451606400
                  },
                  "endTime": {
                    "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": 1451606400
                  },
                  "mode": {
                    "anyOf": [
                      {
                        "description": "A mode that involves using your personal vehicle or legs",
                        "type": "string",
                        "enum": [
                          "WALK",
                          "BICYCLE",
                          "CAR"
                        ]
                      },
                      {
                        "description": "A mode that involves transit with fixed schedules",
                        "type": "string",
                        "enum": [
                          "TRAM",
                          "SUBWAY",
                          "RAIL",
                          "BUS",
                          "FERRY",
                          "TRANSIT",
                          "TRAIN",
                          "AEROPLANE"
                        ]
                      },
                      {
                        "description": "A mode that is available on-demand for your personal use",
                        "type": "string",
                        "enum": [
                          "CAR",
                          "TAXI",
                          "CABLE_CAR",
                          "GONDOLA",
                          "FUNICULAR",
                          "BUSISH",
                          "TRAINISH"
                        ]
                      }
                    ]
                  },
                  "departureDelay": {
                    "description": "duration in milliseconds (negative values permitted), https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": -9007199254740991
                  },
                  "arrivalDelay": {
                    "description": "duration in milliseconds (negative values permitted), https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": -9007199254740991
                  },
                  "distance": {
                    "description": "Distance in meters",
                    "type": "number",
                    "minimum": 0,
                    "maximum": 40075000,
                    "multipleOf": 0.000001
                  },
                  "route": {
                    "type": "string",
                    "minLength": 1
                  },
                  "routeShortName": {
                    "type": "string",
                    "minLength": 1
                  },
                  "routeLongName": {
                    "type": "string",
                    "minLength": 1
                  },
                  "agencyId": {
                    "type": "string",
                    "minLength": 2
                  },
                  "legGeometry": {
                    "type": "object",
                    "description": "Google encoded polyline, see: https://developers.google.com/maps/documentation/utilities/polylinealgorithm",
                    "properties": {
                      "points": {
                        "type": "string",
                        "minLength": 3,
                        "pattern": "^([\\x5F-\\x7E]*[\\x3F-\\x5E])+$"
                      }
                    },
                    "required": [
                      "points"
                    ],
                    "additionalProperties": false
                  },
                  "fare": {
                    "description": "A fare/price as billed from the user in POINTs",
                    "type": "object",
                    "properties": {
                      "amount": {
                        "type": "integer",
                        "minimum": 0
                      },
                      "currency": {
                        "type": "string",
                        "enum": [
                          "POINT"
                        ]
                      }
                    },
                    "required": [
                      "amount",
                      "currency"
                    ],
                    "additionalProperties": false
                  },
                  "product": {
                    "description": "Temporary way to define what kind of product has been purchased to get a ticket/booking. Will be replaced something more sophisticated once proper product system will be development.",
                    "type": "object",
                    "properties": {
                      "type": {
                        "description": "A type of ticket/product that this booking is valid for - should be unique within a given region, e.g. 'Single ticket / Lähiseutu 2'. When reusing the tickets in maas-backend, the 'type' field is checked for equality.",
                        "type": "string"
                      },
                      "id": {
                        "description": "Id of the product retrived from Database",
                        "type": "integer"
                      }
                    },
                    "additionalProperties": false
                  },
                  "bookingOption": {
                    "type": "number",
                    "minValue": 0
                  }
                },
                "required": [
                  "from",
                  "to",
                  "mode",
                  "startTime",
                  "endTime",
                  "legGeometry"
                ],
                "additionalProperties": true
              },
              {
                "type": "object",
                "additionalProperties": true,
                "properties": {
                  "startTime": {
                    "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": 1451606400
                  },
                  "endTime": {
                    "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": 1451606400
                  },
                  "mode": {
                    "description": "A mode that only involves waiting in the current location",
                    "type": "string",
                    "enum": [
                      "WAIT"
                    ]
                  }
                },
                "required": [
                  "mode",
                  "startTime",
                  "endTime"
                ]
              },
              {
                "type": "object",
                "additionalProperties": true,
                "properties": {
                  "startTime": {
                    "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": 1451606400
                  },
                  "endTime": {
                    "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                    "type": "integer",
                    "maximum": 9007199254740991,
                    "minimum": 1451606400
                  },
                  "mode": {
                    "description": "A mode that involves changing transports",
                    "type": "string",
                    "enum": [
                      "TRANSFER",
                      "LEG_SWITCH"
                    ]
                  }
                },
                "required": [
                  "mode",
                  "startTime",
                  "endTime"
                ]
              }
            ]
          }
        }
      },
      "definitions": {
        "leg": {
          "properties": {
            "id": {
              "description": "Universally unique identifier, see https://en.wikipedia.org/wiki/Universally_unique_identifier",
              "type": "string",
              "pattern": "^[A-Fa-f0-9]{8}(-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}$"
            }
          },
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "signature": {
                  "type": "string"
                },
                "state": {
                  "type": "string",
                  "enum": [
                    "START",
                    "PLANNED",
                    "PAID",
                    "ACTIVATED",
                    "CANCELLED",
                    "CANCELLED_WITH_ERRORS",
                    "FINISHED"
                  ]
                },
                "from": {
                  "type": "object",
                  "additionalProperties": true,
                  "allOf": [
                    {
                      "description": "A place, as a location-name pair",
                      "type": "object",
                      "allOf": [
                        {
                          "description": "Geographic latitude-longitude object in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                          "type": "object",
                          "properties": {
                            "lat": {
                              "description": "Geographic latitude (north-south axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                              "type": "number",
                              "minimum": -90,
                              "maximum": 90,
                              "multipleOf": 0.000001
                            },
                            "lon": {
                              "description": "Geographic longitude (east-west axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                              "type": "number",
                              "minimum": -180,
                              "maximum": 180,
                              "multipleOf": 0.000001
                            }
                          },
                          "required": [
                            "lat",
                            "lon"
                          ]
                        },
                        {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "minLength": 1
                            }
                          }
                        }
                      ]
                    },
                    {
                      "type": "object",
                      "properties": {
                        "stopId": {
                          "type": "string",
                          "minLength": 1
                        },
                        "stopCode": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    }
                  ],
                  "required": [
                    "lat",
                    "lon"
                  ]
                },
                "to": {
                  "type": "object",
                  "additionalProperties": true,
                  "allOf": [
                    {
                      "description": "A place, as a location-name pair",
                      "type": "object",
                      "allOf": [
                        {
                          "description": "Geographic latitude-longitude object in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                          "type": "object",
                          "properties": {
                            "lat": {
                              "description": "Geographic latitude (north-south axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                              "type": "number",
                              "minimum": -90,
                              "maximum": 90,
                              "multipleOf": 0.000001
                            },
                            "lon": {
                              "description": "Geographic longitude (east-west axis) in WGS-84 system, see https://en.wikipedia.org/wiki/World_Geodetic_System",
                              "type": "number",
                              "minimum": -180,
                              "maximum": 180,
                              "multipleOf": 0.000001
                            }
                          },
                          "required": [
                            "lat",
                            "lon"
                          ]
                        },
                        {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "minLength": 1
                            }
                          }
                        }
                      ]
                    },
                    {
                      "type": "object",
                      "properties": {
                        "stopId": {
                          "type": "string",
                          "minLength": 1
                        },
                        "stopCode": {
                          "type": "string",
                          "minLength": 1
                        }
                      }
                    }
                  ],
                  "required": [
                    "lat",
                    "lon"
                  ]
                },
                "startTime": {
                  "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": 1451606400
                },
                "endTime": {
                  "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": 1451606400
                },
                "mode": {
                  "anyOf": [
                    {
                      "description": "A mode that involves using your personal vehicle or legs",
                      "type": "string",
                      "enum": [
                        "WALK",
                        "BICYCLE",
                        "CAR"
                      ]
                    },
                    {
                      "description": "A mode that involves transit with fixed schedules",
                      "type": "string",
                      "enum": [
                        "TRAM",
                        "SUBWAY",
                        "RAIL",
                        "BUS",
                        "FERRY",
                        "TRANSIT",
                        "TRAIN",
                        "AEROPLANE"
                      ]
                    },
                    {
                      "description": "A mode that is available on-demand for your personal use",
                      "type": "string",
                      "enum": [
                        "CAR",
                        "TAXI",
                        "CABLE_CAR",
                        "GONDOLA",
                        "FUNICULAR",
                        "BUSISH",
                        "TRAINISH"
                      ]
                    }
                  ]
                },
                "departureDelay": {
                  "description": "duration in milliseconds (negative values permitted), https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": -9007199254740991
                },
                "arrivalDelay": {
                  "description": "duration in milliseconds (negative values permitted), https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": -9007199254740991
                },
                "distance": {
                  "description": "Distance in meters",
                  "type": "number",
                  "minimum": 0,
                  "maximum": 40075000,
                  "multipleOf": 0.000001
                },
                "route": {
                  "type": "string",
                  "minLength": 1
                },
                "routeShortName": {
                  "type": "string",
                  "minLength": 1
                },
                "routeLongName": {
                  "type": "string",
                  "minLength": 1
                },
                "agencyId": {
                  "type": "string",
                  "minLength": 2
                },
                "legGeometry": {
                  "type": "object",
                  "description": "Google encoded polyline, see: https://developers.google.com/maps/documentation/utilities/polylinealgorithm",
                  "properties": {
                    "points": {
                      "type": "string",
                      "minLength": 3,
                      "pattern": "^([\\x5F-\\x7E]*[\\x3F-\\x5E])+$"
                    }
                  },
                  "required": [
                    "points"
                  ],
                  "additionalProperties": false
                },
                "fare": {
                  "description": "A fare/price as billed from the user in POINTs",
                  "type": "object",
                  "properties": {
                    "amount": {
                      "type": "integer",
                      "minimum": 0
                    },
                    "currency": {
                      "type": "string",
                      "enum": [
                        "POINT"
                      ]
                    }
                  },
                  "required": [
                    "amount",
                    "currency"
                  ],
                  "additionalProperties": false
                },
                "product": {
                  "description": "Temporary way to define what kind of product has been purchased to get a ticket/booking. Will be replaced something more sophisticated once proper product system will be development.",
                  "type": "object",
                  "properties": {
                    "type": {
                      "description": "A type of ticket/product that this booking is valid for - should be unique within a given region, e.g. 'Single ticket / Lähiseutu 2'. When reusing the tickets in maas-backend, the 'type' field is checked for equality.",
                      "type": "string"
                    },
                    "id": {
                      "description": "Id of the product retrived from Database",
                      "type": "integer"
                    }
                  },
                  "additionalProperties": false
                },
                "bookingOption": {
                  "type": "number",
                  "minValue": 0
                }
              },
              "required": [
                "from",
                "to",
                "mode",
                "startTime",
                "endTime",
                "legGeometry"
              ],
              "additionalProperties": true
            },
            {
              "type": "object",
              "additionalProperties": true,
              "properties": {
                "startTime": {
                  "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": 1451606400
                },
                "endTime": {
                  "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": 1451606400
                },
                "mode": {
                  "description": "A mode that only involves waiting in the current location",
                  "type": "string",
                  "enum": [
                    "WAIT"
                  ]
                }
              },
              "required": [
                "mode",
                "startTime",
                "endTime"
              ]
            },
            {
              "type": "object",
              "additionalProperties": true,
              "properties": {
                "startTime": {
                  "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": 1451606400
                },
                "endTime": {
                  "description": "POSIX time in milliseconds, https://en.wikipedia.org/wiki/Unix_time",
                  "type": "integer",
                  "maximum": 9007199254740991,
                  "minimum": 1451606400
                },
                "mode": {
                  "description": "A mode that involves changing transports",
                  "type": "string",
                  "enum": [
                    "TRANSFER",
                    "LEG_SWITCH"
                  ]
                }
              },
              "required": [
                "mode",
                "startTime",
                "endTime"
              ]
            }
          ]
        },
        "bookingOption": {
          "$schema": "http://json-schema.org/draft-04/schema#",
          "id": "https://api.maas.global/core/itinerary",
          "description": "Booking option for an itinerary, is either an existing booking pointer or a new booking instruction",
          "type": "object",
          "properties": {
            "productId": {},
            "name": {},
            "fare": {},
            "ref": {},
            "identityId": {},
            "bookingId": {}
          }
        }
      }
    }
  },
  "required": [
    "itinerary"
  ],
  "additionalProperties": false
}